FROM node:20-alpine

WORKDIR /repo

RUN corepack enable
RUN corepack prepare pnpm@10.29.3 --activate

COPY package.json pnpm-lock.yaml pnpm-workspace.yaml tsconfig.base.json ./
COPY apps/web/package.json apps/web/package.json

RUN pnpm config set store-dir /pnpm-store && pnpm install

EXPOSE 5173
CMD ["pnpm", "--filter", "web", "dev", "--host", "0.0.0.0", "--port", "5173"]